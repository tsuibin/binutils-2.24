From 0102ea8cec5fc509bba6c91df61b7ce23a799d32 Mon Sep 17 00:00:00 2001
From: Nick Clifton <nickc@redhat.com>
Date: Thu, 30 Oct 2014 17:16:17 +0000
Subject: [PATCH] Fixes a seg-fault in the ihex parser when it encounters a malformed ihex file.

	PR binutils/17512
	* ihex.c (ihex_scan): Fix typo in invocation of ihex_bad_byte.

[Ubuntu note: patch differs from upstream commit in that it drops the
changelog entry to reduce patch conflicts. -- sbeattie]

CVE-2014-8503
---
 bfd/ChangeLog |    1 +
 bfd/ihex.c    |    2 +-
 2 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/bfd/ihex.c b/bfd/ihex.c
index 8d3590d..9b3b813 100644
--- a/bfd/ihex.c
+++ b/bfd/ihex.c
@@ -321,7 +321,7 @@ ihex_scan (bfd *abfd)
 	    {
 	      if (! ISHEX (buf[i]))
 		{
-		  ihex_bad_byte (abfd, lineno, hdr[i], error);
+		  ihex_bad_byte (abfd, lineno, buf[i], error);
 		  goto error_return;
 		}
 	    }
-- 
1.7.1

